### 图像超分辨率


#### SRCNN

第一篇深度学习超分辨率网络。SRCNN首先使用双三次(bicubic)插值将低分辨率图像放大成目标尺寸，接着通过三层卷积网络拟合非线性映射，最后输出高分辨率图像结果。


<img src="../picture/vision-sp-1.png" width = "600" height = "250" alt="" align=center />


#### FSRCNN

FSRCNN是对之前SRCNN的改进，主要在三个方面：一是在最后使用了一个**反卷积层**放大尺寸，因此可以直接将原始的低分辨率图像输入到网络中。二是改变特征维数，使用更小的卷积核和使用更多的映射层。三是可以共享其中的映射层，如果需要训练不同上采样倍率的模型，只需要fine-tuning最后的反卷积层。


#### ESPCN

ESPCN的核心概念是亚像素卷积层($\textit{PixelShuffle}$)


#### LapSRN

LapSRN的结构可以看成有多级，每一级完成一次2倍的上采样操作，要实现8倍的上采样就需要有三级。在每一级中，先通过一些级联的卷积层提取特征，接着通过一个**反卷积层**将提取出的特征的尺寸上采样2倍。反卷积层后连有两个卷积层，一个卷积层的作用是继续提取特征，另外一个卷积层的作用是预测出这一级的残差。输入图像在每一级也经过一个反卷积层使尺寸上采样2倍，再与对应级的残差相加，就能重构出这一级的上采样结果

#### EDSR

EDSR在结构上与SRResNet相比，就是把BN操作给去掉了。

#### RCAN

引入Attention机制来区别对待不同的通道，从而可以提高网络的表征能力；提出了新的Residual in Residual （RIR）结构，因而网络可以更深；

#### 指标计算

1. 结构相似度

$$\textit{SSIM}=\frac{(2\mu_x\mu_y+c_1)(2\sigma_{xy}+c_2)}{(\mu_x^2+\mu_y^2+c1)(\sigma_x^2+\sigma_y^2+c_2)}$$

2. 峰值信噪比
$$\textit{PSNR} = 10\cdot\log_{10}\frac{Max_I^2}{MSE(x,y)}$$

#### 其他

1. 拉普拉斯金字塔（Laplacian pyramid）：在进行高斯金字塔运算时，由于不断的进行高斯滤波和下采样，我们丢失了很多高频信号，而拉普拉斯金字塔的目的就是保存这些高频信号，保存这些高频信号所采用的方式就是保存差分图像。比如，拉普拉斯金字塔的第０层，就是原始图像和原始图像下采样（Reduce）后再次上采样（Expand）的图像的差值。
2. 双三次插值(Bicubic interpolation)

假设源图像$A$大小为$m\times n$，缩放$K$倍后的目标图像$B$的大小为$M\times N$，即$K=\frac{M}{m}$。$A$的每一个像素点是已知的，$B$是未知的，我们想要求出目标图像$B$中每一像素点$(X,Y)$的值，必须先找出像素$(X,Y)$在源图像$A$中对应的像素$(x,y)$，再根据源图像$A$距离像素$(x,y)$最近的16个像素点作为计算目标图像$B(X,Y)$处像素值的参数，利用BiCubic基函数求出16个像素点的权重，图B像素$(x,y)$的值就等于16个像素点的加权叠加。



<img src="../picture/vision-sp-2.png" width = "300" height = "250" alt="" align=center />

根据比例关系$\frac{x}{X}=\frac{m}{M}=\frac{1}{K}$，我们可以得到$B(X,Y)$在A上的对应坐标为$A(x,y)=A(X\frac{m}{M},Y\frac{n}{N}=A(\frac{X}{K},\frac{Y}{K})$。如图所示P点就是目标图像B在$(X,Y)$处对应于源图像A中的位置，P的坐标位置会出现小数部分，所以我们假设 P的坐标为$P(x+u,y+v)$，其中$x,y$分别表示整数部分，$u,v$分别表示小数部分（蓝点到$a_{11}$方格中红点的距离）。那么我们就可以得到如图所示的最近16个像素的位置，在这里用$a(i,j)(i,j=0,1,2,3)$来表示，如上图。Bicbic函数的权重计算如下图所示


<img src="../picture/vision-sp-3.png" width = "350" height = "100" alt="" align=center />

BiCubic函数中的参数x表示该像素点到P点的距离，例如 $a_{00}$ 距离$P(x+u,y+v)$的距离为 $(1+u,1+v)$，因此$a_{00}$的横坐标权重 $i_0=W(1+u)$，纵坐标权重$j_0=W(1+v)$，$a_{00} $对 $B(X,Y)$ 的贡献值为：$(a_{00}像素)* i_0* j_0$。因此，$a_{0X}$的横坐标权重分别为$W(1+u)，W(u)，W(1-u)，W(2-u)$；$a_{y0}$的纵坐标权重分别为$W(1+v)，W(v)，W(1-v)，W(2-v)$；B(X,Y)像素值为：

$$B(X,Y)=\sum^3_{i=0}\sum^3_{j=0}a_{ij}\times W(i)\times W(j)$$